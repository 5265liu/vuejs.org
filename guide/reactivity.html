
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>深入响应式原理 (Reactivity in Depth) - vue.js</title>
        <meta charset="utf-8">
        <meta name="description" content="Vue.js - Intuitive, Fast and Composable MVVM for building interactive interfaces.">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Dosis:500&text=Vue.js' rel='stylesheet' type='text/css'>
        <link href="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel='stylesheet' type='text/css'>
        <link rel="icon" href="/vuejs.org/images/logo.png" type="image/x-icon">
        <script>
            window.PAGE_TYPE = "guide"
        </script>
        <link rel="stylesheet" href="/vuejs.org/css/page.css">
        <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46852172-1', 'vuejs.org');
  ga('send', 'pageview');
</script>
        <script src="/vuejs.org/js/vue.js"></script>
        <script async defer src="https://buttons.github.io/buttons.js"></script>
    </head>
    <body class="docs">        <div id="mobile-bar" >
            <a class="menu-button"></a>
            <a class="logo" href="/vuejs.org/"></a>
        </div>
        <div id="header">
  <a id="logo" href="/vuejs.org/">
    <img src="/vuejs.org/images/logo.png">
    <span>Vue.js</span>
  </a>
  <ul id="nav">
    <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input" style="background-image: url(/vuejs.org/images/search.png)">
  </form>
</li>
<li><a href="/vuejs.org/guide/" class="nav-link current">教程</a></li>
<li><a href="/vuejs.org/api/" class="nav-link">API</a></li>
<li><a href="/vuejs.org/examples/" class="nav-link">示例</a></li>
<li><a href="https://medium.com/the-vue-point" target="_blank" class="nav-link">博客</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">社区</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/vuejs/vue" class="nav-link" target="_blank">GitHub</a></li>
    <li><a href="http://forum.vuejs.org" class="nav-link" target="_blank">论坛</a></li>
    <li><a href="https://gitter.im/vuejs/vue" class="nav-link" target="_blank">聊天室</a></li>
    <li><a href="https://twitter.com/vuejs" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>


  </ul>
</div>

        
            <div id="main" class="fix-sidebar">
                
                    
    <div class="sidebar">
    <ul class="main-menu">
        <li>
  <form id="search-form">
    <input type="text" id="search-query-sidebar" class="search-query st-default-search-input" style="background-image: url(/vuejs.org/images/search.png)">
  </form>
</li>
<li><a href="/vuejs.org/guide/" class="nav-link current">教程</a></li>
<li><a href="/vuejs.org/api/" class="nav-link">API</a></li>
<li><a href="/vuejs.org/examples/" class="nav-link">示例</a></li>
<li><a href="https://medium.com/the-vue-point" target="_blank" class="nav-link">博客</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">社区</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/vuejs/vue" class="nav-link" target="_blank">GitHub</a></li>
    <li><a href="http://forum.vuejs.org" class="nav-link" target="_blank">论坛</a></li>
    <li><a href="https://gitter.im/vuejs/vue" class="nav-link" target="_blank">聊天室</a></li>
    <li><a href="https://twitter.com/vuejs" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>


    </ul>
    <div class="list">
        <div id="donate" style="margin-bottom: 20px">
            <span class="wrapper" style="width: 110px">
              <img src="/vuejs.org/images/patreon.png">
              <a href="/vuejs.org/support-vuejs" title="支持 Vue.js">支持 Vue.js</a>
            </span>
        </div>
        <a class="github-button" href="https://github.com/hayeah/vuejs.org/issues" data-count-api="/repos/hayeah/vuejs.org#open_issues_count" data-count-aria-label="# issues on GitHub" aria-label="Issue hayeah/vuejs.org on GitHub">给翻译组提意见</a>
        <h2>
            Guide
            <select class="version-select">
                <option value="SELF" selected>2.0</option>
                <option value="v1">1.0</option>
                <option value="012">0.12</option>
                <option value="011">0.11</option>
            </select>
        </h2>
        <ul class="menu-root">
            
                
                
                  <li><h3>核心</h3></li>
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/installation.html" class="sidebar-link">安装 (Installation)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/index.html" class="sidebar-link">Introduction</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/instance.html" class="sidebar-link">Vue 实例 (The Vue Instance)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/syntax.html" class="sidebar-link">模版语法 (Template Syntax)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/computed.html" class="sidebar-link">计算属性和监视器 (Computed Properties and Watchers)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/class-and-style.html" class="sidebar-link">class 与 style 绑定 (Class and Style Bindings)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/conditional.html" class="sidebar-link">条件渲染 (Conditional Rendering)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/list.html" class="sidebar-link">列表渲染 (List Rendering)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/events.html" class="sidebar-link">Event Handling</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/forms.html" class="sidebar-link">表单控件绑定 (Form Input Bindings)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/components.html" class="sidebar-link">组件 (Components)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/reactivity.html" class="sidebar-link current">深入响应式原理 (Reactivity in Depth)</a>
                </li>
            
                
                
                
                  <li><h3>进阶</h3></li>
                
                
                
                <li>
                    <a href="/vuejs.org/guide/transitions.html" class="sidebar-link">Transition Effects</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/transitioning-state.html" class="sidebar-link">Transitioning State</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/render-function.html" class="sidebar-link">渲染函数 (Render Functions)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/custom-directive.html" class="sidebar-link">自定义指令 (Custom Directives)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/mixins.html" class="sidebar-link">Mixins</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/plugins.html" class="sidebar-link">插件 (Plugins)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/single-file-components.html" class="sidebar-link">Single File Components</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/deployment.html" class="sidebar-link">Deploying For Production</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/routing.html" class="sidebar-link">路由 (Routing)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/state-management.html" class="sidebar-link">状态管理 (State Management)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/unit-testing.html" class="sidebar-link">单元测试 (Unit Testing)</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/ssr.html" class="sidebar-link">Server-Side Rendering</a>
                </li>
            
                
                
                
                
                  <li><h3>迁移</h3></li>
                
                
                <li>
                    <a href="/vuejs.org/guide/migration.html" class="sidebar-link">从 Vue 1.x 迁移（Migration from Vue 1.x）</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/migration-vue-router.html" class="sidebar-link">Migration from Vue Router 0.7.x</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/migration-vuex.html" class="sidebar-link">从 Vuex 0.6.x 迁移到 1.0 (Migration from Vuex 0.6.x to 1.0)</a>
                </li>
            
                
                
                
                
                
                  <li><h3>更多</h3></li>
                
                <li>
                    <a href="/vuejs.org/guide/comparison.html" class="sidebar-link">Comparison with Other Frameworks</a>
                </li>
            
                
                
                
                
                
                <li>
                    <a href="/vuejs.org/guide/join.html" class="sidebar-link">加入 vue.js 社区！ (Join the Vue.js Community!)</a>
                </li>
            
        </ul>
    </div>
</div>


<div class="content guide with-sidebar reactivity-guide">
    
      <div id="ad">
  <span>Sponsored By</span><br>
  <a href="http://www.thedifferenceengine.io/" target="_blank"
    style="background-color: rgba(0,0,0,.85); padding: 10px 0">
    <img src="/vuejs.org/images/tde.png">
  </a>
  <!-- <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=vuejs" id="_carbonads_js"></script> -->
  <a class="github-button" href="https://github.com/hayeah/vuejs.org/issues" data-count-api="/repos/hayeah/vuejs.org#open_issues_count" data-count-aria-label="# issues on GitHub" aria-label="Issue hayeah/vuejs.org on GitHub">给翻译组提意见</a>

</div>

    
    
      <h1>深入响应式原理 (Reactivity in Depth)</h1>
    
    <p>We’ve covered most of the basics - now it’s time to take a deep dive! One of Vue’s most distinct features is the unobtrusive reactivity system. Models are just plain JavaScript objects. When you modify them, the view updates. It makes state management very simple and intuitive, but it’s also important to understand how it works to avoid some common gotchas. In this section, we are going to dig into some of the lower-level details of Vue’s reactivity system.<br>前面的章节中，我们已经覆盖了大部分基础内容，是时候来点有深度的了。Vue 最具特色的一个功能是响应式系统。模型只作为普通对象存在。当你修改它们，视图会随之更新。这让状态管理非常简单且直观，不过，理解它的工作原理对于避免踩一些常见的坑来说，也是很重要的。在本节中，我们将探究一些 Vue 的响应式系统的底层细节。</p>
<h2 id="如何追踪变化-How-Changes-Are-Tracked"><a href="#如何追踪变化-How-Changes-Are-Tracked" class="headerlink" title="如何追踪变化 (How Changes Are Tracked)"></a>如何追踪变化 (How Changes Are Tracked)</h2><p>When you pass a plain JavaScript object to a Vue instance as its <code>data</code> option, Vue will walk through all of its properties and convert them to getter/setters using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="external">Object.defineProperty</a>. This is an ES5-only and un-shimmable feature, which is why Vue doesn’t support IE8 and below.<br>把一个普通对象传给 Vue 实例作为它的 <code>data</code> 选项，Vue 将遍历它的属性，并通过 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="external">Object.defineProperty</a> 将它们转为 getter/setter。这是 ES5 特性，不能通过打补丁实现，这也是为什么 Vue 不支持 IE8 及更低版本。</p>
<p>The getter/setters are invisible to the user, but under the hood they enable Vue to perform dependency-tracking and change-notification when properties are accessed or modified. One caveat is that browser consoles format getter/setters differently when converted data objects are logged, so you may want to install <a href="https://github.com/vuejs/vue-devtools" target="_blank" rel="external">vue-devtools</a> for a more inspection-friendly interface.<br>getter/setters 对用户来说是透明的，但是它们让 Vue 有机会追踪依赖，并在属性被访问和修改时得到更变通知。一个需要注意的点是，在浏览器控制台打印数据对象时对于 getter/setter 的格式处理方式不尽相同，你可以考虑使用 <a href="https://github.com/vuejs/vue-devtools" target="_blank" rel="external">vue-devtools</a> 来得到更为方便追踪数据（inspection-friendly）的界面。</p>
<p>Every component instance has a corresponding <strong>watcher</strong> instance, which records any properties “touched” during the component’s render as dependencies. Later on when a dependency’s setter is triggered, it notifies the watcher, which in turn causes the component to re-render.<br>每个组件实例拥有一个对应的 <strong>watcher</strong> 实例，这个 <strong>watcher</strong> 会记录任何在组件渲染时使用到的属性作为依赖。之后，当依赖属性的 setter 被调用时，会通知到 watcher，从而触发组件更新。</p>
<p><img src="/images/data.png" alt="Reactivity Cycle"></p>
<h2 id="变化检测注意事项-Change-Detection-Caveats"><a href="#变化检测注意事项-Change-Detection-Caveats" class="headerlink" title="变化检测注意事项 (Change Detection Caveats)"></a>变化检测注意事项 (Change Detection Caveats)</h2><p>Due to the limitations of modern JavaScript (and the abandonment of <code>Object.observe</code>), Vue <strong>cannot detect property addition or deletion</strong>. Since Vue performs the getter/setter conversion process during instance initialization, a property must be present in the <code>data</code> object in order for Vue to convert it and make it reactive. For example:<br>受现代 JavaScript （以及 <code>Object.observe</code> 方法的废弃） 的限制，Vue <strong>无法检测到对象属性的添加或删除</strong>。Vue 是在实例初始化过程中执行 getter/setter 的转换，因此，只有在 data 对象中的属性，才能保证被 Vue 转换为响应式的（reactive）。例如：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">a</span>: <span class="number">1</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"><span class="comment">// `vm.a` is now reactive</span></div><div class="line"><span class="comment">// `vm.a` 是响应式的</span></div><div class="line"></div><div class="line">vm.b = <span class="number">2</span></div><div class="line"><span class="comment">// `vm.b` is NOT reactive</span></div><div class="line"><span class="comment">// `vm.b` 不是响应式的</span></div></pre></td></tr></table></figure>
<p>Vue does not allow dynamically adding new root-level reactive properties to an already created instance. However, it’s possible to add reactive properties to a nested object using the <code>Vue.set(object, key, value)</code> method:<br>Vue 不允许动态添加新的根级（root-level）响应式属性（reactive properties）到已存在的实例中。但是，可以通过 <code>Vue.set(object, key, value)</code> 方法添加响应式的属性到一个嵌套对象中：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><div class="line">Vue.set(vm.someObject, <span class="string">'b'</span>, <span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>You can also use the <code>vm.$set</code> instance method, which is just an alias to the global <code>Vue.set</code>:<br>你也可以使用 <code>vm.$set</code> 这个实例方法，它仅仅是全局方法 <code>Vue.set</code> 的别名：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><div class="line"><span class="keyword">this</span>.$set(<span class="keyword">this</span>.someObject, <span class="string">'b'</span>, <span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>Sometimes you may want to assign a number of properties to an existing object, for example using <code>Object.assign()</code> or <code>_.extend()</code>. However, new properties added to the object will not trigger changes. In such cases, create a fresh object with properties from both the original object and the mixin object:<br>有些时候你可能希望添加多个属性到一个已存在的对象中，例如使用 <code>Object.assign()</code> 或者 <code>_.extend()</code>。然而，新增的属性并不能被触发更新。在这种情况下，应该使用原始对象和新增属性创建一个新的对象：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><div class="line"><span class="comment">// instead of `Object.assign(this.someObject, &#123; a: 1, b: 2 &#125;)`</span></div><div class="line"><span class="comment">// 替代 `Object.assign(this.someObject, &#123; a: 1, b: 2 &#125;)`</span></div><div class="line"><span class="keyword">this</span>.someObject = <span class="built_in">Object</span>.assign(&#123;&#125;, <span class="keyword">this</span>.someObject, &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;)</div></pre></td></tr></table></figure>
<p>There are also a few array-related caveats, which were discussed earlier in the <a href="/guide/list.html#Caveats">list rendering section</a>.<br>还有一些数组相关的问题，之前已经在<a href="/guide/list.html#">列表渲染章节</a>中讨论过了。</p>
<h2 id="声明响应式属性-Declaring-Reactive-Properties"><a href="#声明响应式属性-Declaring-Reactive-Properties" class="headerlink" title="声明响应式属性 (Declaring Reactive Properties)"></a>声明响应式属性 (Declaring Reactive Properties)</h2><p>Since Vue doesn’t allow dynamically adding root-level reactive properties, you have to initialize Vue instances by declaring all root-level reactive data properties upfront, even just with an empty value:<br>由于 Vue 不允许动态添加根级响应式属性，你必须在初始化 Vue 实例时，事先声明所有根级响应式属性，即使该属性的值为空：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="comment">// declare message with an empty value</span></div><div class="line">    <span class="comment">// 用空字符串声明 message</span></div><div class="line">    message: <span class="string">''</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">template</span>: <span class="string">'&lt;div&gt;&#123;&#123; message &#125;&#125;&lt;/div&gt;'</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">// set `message` later</span></div><div class="line"><span class="comment">// 后续设置 `message` 的值</span></div><div class="line">vm.message = <span class="string">'Hello!'</span></div></pre></td></tr></table></figure>
<p>If you don’t declare <code>message</code> in the data option, Vue will warn you that the render function is trying to access a property that doesn’t exist.<br>如果你没有在 data 选项中声明 <code>message</code>，Vue 会发出警告：render 函数尝试访问一个不存在的属性。</p>
<p>There are technical reasons behind this restriction - it eliminates a class of edge cases in the dependency tracking system, and also makes Vue instances play nicer with type checking systems. But there is also an important consideration in terms of code maintainability: the <code>data</code> object is like the schema for your component’s state. Declaring all reactive properties upfront makes the component code easier to understand when revisited later or read by another developer.<br>这个限制是出于技术角度的考量——这样设计消除了依赖追踪系统中一些边缘情况，同时也使 Vue 实例更好的与类型检查系统协作。除此之外还有一个出于代码维护方面的重要考虑：<code>data</code> 被视作组件状态的结构描述（schema）。事先声明所有响应式属性可以让组件代码在之后重读或者他人阅读时更易于理解。</p>
<h2 id="异步更新队列-Async-Update-Queue"><a href="#异步更新队列-Async-Update-Queue" class="headerlink" title="异步更新队列 (Async Update Queue)"></a>异步更新队列 (Async Update Queue)</h2><p>In case you haven’t noticed yet, Vue performs DOM updates <strong>asynchronously</strong>. Whenever a data change is observed, it will open a queue and buffer all the data changes that happen in the same event loop. If the same watcher is triggered multiple times, it will be pushed into the queue only once. This buffered de-duplication is important in avoiding unnecessary calculations and DOM manipulations. Then, in the next event loop “tick”, Vue flushes the queue and performs the actual (already de-duped) work. Internally Vue tries native <code>Promise.then</code> and <code>MutationObserver</code> for the asynchronous queuing and falls back to <code>setTimeout(fn, 0)</code>.<br>如果你还没有注意到，Vue 是<strong>异步</strong>执行 DOM 更新的。当数据更变被观察到时，它会开启一个队列并缓存相同事件循环中所有的数据更变到该队列中。如果相同的 watcher 被触发了多次，也只会被推到队列中一次。这个缓冲去重（buffered de-duplication）机制对于避免重复计算和多余的 DOM 操作来说是至关重要的。之后，在下个事件循环帧中，Vue 刷新队列并执行实际的（已被去重的）工作。在内部优先使用 <code>Promise.then</code> 和 <code>MutationObserver</code> 来实现异步队列，如果不支持则使用 setTimeout(fn, 0)。</p>
<p>For example, when you set <code>vm.someData = &#39;new value&#39;</code>, the component will not re-render immediately. It will update in the next “tick”, when the queue is flushed. Most of the time we don’t need to care about this, but it can be tricky when you want to do something that depends on the post-update DOM state. Although Vue.js generally encourages developers to think in a “data-driven” fashion and avoid touching the DOM directly, sometimes it might be necessary to get your hands dirty. In order to wait until Vue.js has finished updating the DOM after a data change, you can use <code>Vue.nextTick(callback)</code> immediately after the data is changed. The callback will be called after the DOM has been updated. For example:<br>例如，当你设置 <code>vm.someData = &#39;new value&#39;</code> 时，DOM 并不会立即更新。它将在下一次事件循环清空队列时更新。大多数情况下下我们不太需要关心这个，但是如果想在 DOM 状态更新后做点什么就会有些麻烦了。尽管 Vue.js 鼓励开发者秉承数据驱动的思想，不要直接接触 DOM，但是有些场景确是难以避免需要这样做。为了在数据变化之后等待 Vue.js 完成 DOM 更新，可以在数据变化之后立即使用 <code>Vue.nextTick(callback)</code>。callback 将在 DOM 更新完成后调用。例如：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example"</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">el</span>: <span class="string">'#example'</span>,</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">message</span>: <span class="string">'123'</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line">vm.message = <span class="string">'new message'</span> <span class="comment">// change data // 修改数据</span></div><div class="line">vm.$el.textContent === <span class="string">'new message'</span> <span class="comment">// false</span></div><div class="line">Vue.nextTick(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  vm.$el.textContent === <span class="string">'new message'</span> <span class="comment">// true</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>There is also the <code>vm.$nextTick()</code> instance method, which is especially handy inside components, because it doesn’t need global <code>Vue</code> and its callback’s <code>this</code> context will be automatically bound to the current Vue instance:<br><code>vm.$nextTick()</code> 实例方法也可以使用，在组件内部使用尤其方便，因为它不需要全局的 <code>Vue</code>，同时回调函数中的 <code>this</code> 也会自动绑定到当前 Vue 实例：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><div class="line">Vue.component(<span class="string">'example'</span>, &#123;</div><div class="line">  <span class="attr">template</span>: <span class="string">'&lt;span&gt;&#123;&#123; message &#125;&#125;&lt;/span&gt;'</span>,</div><div class="line">  <span class="attr">data</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">message</span>: <span class="string">'not updated'</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">methods</span>: &#123;</div><div class="line">    <span class="attr">updateMessage</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">this</span>.message = <span class="string">'updated'</span></div><div class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.$el.textContent) <span class="comment">// =&gt; 'not updated'</span></div><div class="line">      <span class="keyword">this</span>.$nextTick(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.$el.textContent) <span class="comment">// =&gt; 'updated'</span></div><div class="line">      &#125;)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
    
      <div class="guide-links">
        
          <span>← <a href="/vuejs.org/guide/components.html">组件 (Components)</a></span>
        
        
          <span style="float:right"><a href="/vuejs.org/guide/transitions.html">Transition Effects</a> →</span>
        
      </div>
    
    <div class="footer">
      Caught a mistake or want to contribute to the documentation?
      <a href="https://github.com/vuejs/vuejs.org/blob/master/src/guide/reactivity.md" target="_blank">
        Edit this page on Github!
      </a>
    </div>
</div>

                
            </div>
            <script src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
            <script src="/vuejs.org/js/smooth-scroll.min.js"></script>
            <script src="/vuejs.org/js/common.js"></script>
        

        <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                FastClick.attach(document.body);
            }, false);
        </script>
    </body>
</html>
